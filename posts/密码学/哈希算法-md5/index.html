<!doctype html>































<html
  class="not-ready lg:text-base"
  style="--bg: #faf8f1"
  lang="zh-CN"
  dir="ltr"
>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title>MD5详解 - huolong blog</title>

  
  <meta name="theme-color" />

  
  
  
  
  <meta name="description" content="MD5（Message Digest Algorithm 5）是逆向中常见的一种签名生成算法，主要特点如下：

输入任意长度，输出 128 bit 固定长度的信息摘要。
运算速度快，MD5 中的运算以位运算（异或，与，或，非等）。
不可逆但已经发现碰撞。

算法原理
填充数据
首先需要对输入的数据进行填充，填充的第一位为 1，其余位为 0，使其最终长度模 512 的结果为 448（填充必须进行，哪怕长度正好满足要求，也会再填充 512 bit 的数据）。剩余 64 bit 填入原始长度。这时数据长度可以整除 512，将每 512 bit 数据作为一个分组。
分组数据运算
首先赋值四个初始链接变量，作为后续操作的基础：
A: 0x67452301 B: 0xefcdab89 C: 0x98badcfe D: 0x10325476
随后要提到四个非线性函数：
F(X,Y,Z)=(X&amp;Y)|(~X&amp;Z)
G(X,Y,Z)=(X&amp;Z)|(Y&amp;~Z)
H(X,Y,Z)=X^Y^Z
I(X,Y,Z)=Y^(X|~Z)
基于这四种非线性函数，MD5 会对每个分组进行 4 轮总共 64 次操作，以下操作的 a,b,c,d 初值等于上面的初始链接变量：
// 第一轮 FF(a,b,c,d,Mi,s,tj) 表示a=b&#43;((a&#43;F(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s)，其中&lt;&lt;&lt;表示循环左移
// Mi表示消息的子分组，因为每个分组为512bit，可以分为16个32bit的子分组
// tj表示常数数组的特定元素，由4294967296*abs(sin(j))的整数部分得到
FF(a,b,c,d,M0,7,0xd76aa478)
FF(d,a,b,c,M1,12,0xe8c7b756)
FF(c,d,a,b,M2,17,0×242070db)
FF(b,c,d,a,M3,22,0xc1bdceee)
FF(a,b,c,d,M4,7,0xf57c0faf)
FF(d,a,b,c,M5,12,0×4787c62a)
FF(c,d,a,b,M6,17,0xa8304613)
FF(b,c,d,a,M7,22,0xfd469501)
FF(a,b,c,d,M8,7,0×698098d8)
FF(d,a,b,c,M9,12,0×8b44f7af)
FF(c,d,a,b,M10,17,0xffff5bb1)
FF(b,c,d,a,M11,22,0×895cd7be)
FF(a,b,c,d,M12,7,0×6b901122)
FF(d,a,b,c,M13,12,0xfd987193)
FF(c,d,a,b,M14,17,0xa679438e)
FF(b,c,d,a,M15,22,0×49b40821)

// 第二轮 GG(a,b,c,d,Mi,s,tj) 表示 a=b&#43;((a&#43;G(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s)
GG(a,b,c,d,M1,5,0xf61e2562)
GG(d,a,b,c,M6,9,0xc040b340)
GG(c,d,a,b,M11,14,0×265e5a51)
GG(b,c,d,a,M0,20,0xe9b6c7aa)
GG(a,b,c,d,M5,5,0xd62f105d)
GG(d,a,b,c,M10,9,0×02441453)
GG(c,d,a,b,M15,14,0xd8a1e681)
GG(b,c,d,a,M4,20,0xe7d3fbc8)
GG(a,b,c,d,M9,5,0×21e1cde6)
GG(d,a,b,c,M14,9,0xc33707d6)
GG(c,d,a,b,M3,14,0xf4d50d87)
GG(b,c,d,a,M8,20,0×455a14ed)
GG(a,b,c,d,M13,5,0xa9e3e905)
GG(d,a,b,c,M2,9,0xfcefa3f8)
GG(c,d,a,b,M7,14,0×676f02d9)
GG(b,c,d,a,M12,20,0×8d2a4c8a)

// 第三轮 HH(a,b,c,d,Mi,s,tj) 表示 a=b&#43;((a&#43;H(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s)
HH(a,b,c,d,M5,4,0xfffa3942)
HH(d,a,b,c,M8,11,0×8771f681)
HH(c,d,a,b,M11,16,0×6d9d6122)
HH(b,c,d,a,M14,23,0xfde5380c)
HH(a,b,c,d,M1,4,0xa4beea44)
HH(d,a,b,c,M4,11,0×4bdecfa9)
HH(c,d,a,b,M7,16,0xf6bb4b60)
HH(b,c,d,a,M10,23,0xbebfbc70)
HH(a,b,c,d,M13,4,0×289b7ec6)
HH(d,a,b,c,M0,11,0xeaa127fa)
HH(c,d,a,b,M3,16,0xd4ef3085)
HH(b,c,d,a,M6,23,0×04881d05)
HH(a,b,c,d,M9,4,0xd9d4d039)
HH(d,a,b,c,M12,11,0xe6db99e5)
HH(c,d,a,b,M15,16,0×1fa27cf8)
HH(b,c,d,a,M2,23,0xc4ac5665)

// 第四轮 II(a,b,c,d,Mi,s,tj) 表示a=b&#43;((a&#43;I(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s)
II(a,b,c,d,M0,6,0xf4292244)
II(d,a,b,c,M7,10,0×432aff97)
II(c,d,a,b,M14,15,0xab9423a7)
II(b,c,d,a,M5,21,0xfc93a039)
II(a,b,c,d,M12,6,0×655b59c3)
II(d,a,b,c,M3,10,0×8f0ccc92)
II(c,d,a,b,M10,15,0xffeff47d)
II(b,c,d,a,M1,21,0×85845dd1)
II(a,b,c,d,M8,6,0×6fa87e4f)
II(d,a,b,c,M15,10,0xfe2ce6e0)
II(c,d,a,b,M6,15,0xa3014314)
II(b,c,d,a,M13,21,0×4e0811a1)
II(a,b,c,d,M4,6,0xf7537e82)
II(d,a,b,c,M11,10,0xbd3af235)
II(c,d,a,b,M2,15,0×2ad7d2bb)
II(b,c,d,a,M9,21,0xeb86d391)
对一个分组执行 64 次操作后，更新 A,B,C,D 与 a,b,c,d 值：" />
  <meta name="author" content="huolong blog" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="https://6uolong.github.io/main.min.css" />

  
  
  
  
  
  <link rel="preload" as="image" href="https://6uolong.github.io/theme.png" />

  
  
  
  
  

  
  
  

  
  
  <script
    defer
    src="https://6uolong.github.io/highlight.min.js"
    onload="hljs.initHighlightingOnLoad();"
  ></script>
  

  
  
  
  
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css"
  integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI"
  crossorigin="anonymous"
/>
<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js"
  integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t"
  crossorigin="anonymous"
></script>
<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js"
  integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
  crossorigin="anonymous"
></script>


<script>
  document.addEventListener('DOMContentLoaded', () =>
    renderMathInElement(document.body, {
      
      
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '$', right: '$', display: false },
      ],
      
      throwOnError: false,
    }),
  );
</script>

  
  
  

  
  <link
    rel="icon"
    href="https://6uolong.github.io/favicon.ico"
  />
  <link
    rel="apple-touch-icon"
    href="https://6uolong.github.io/apple-touch-icon.png"
  />

  
  <meta name="generator" content="Hugo 0.136.5">

  
  
  
  
  
  
  <meta itemprop="name" content="MD5详解">
  <meta itemprop="description" content="MD5（Message Digest Algorithm 5）是逆向中常见的一种签名生成算法，主要特点如下：
输入任意长度，输出 128 bit 固定长度的信息摘要。 运算速度快，MD5 中的运算以位运算（异或，与，或，非等）。 不可逆但已经发现碰撞。 算法原理 填充数据 首先需要对输入的数据进行填充，填充的第一位为 1，其余位为 0，使其最终长度模 512 的结果为 448（填充必须进行，哪怕长度正好满足要求，也会再填充 512 bit 的数据）。剩余 64 bit 填入原始长度。这时数据长度可以整除 512，将每 512 bit 数据作为一个分组。
分组数据运算 首先赋值四个初始链接变量，作为后续操作的基础：
A: 0x67452301 B: 0xefcdab89 C: 0x98badcfe D: 0x10325476 随后要提到四个非线性函数：
F(X,Y,Z)=(X&amp;Y)|(~X&amp;Z) G(X,Y,Z)=(X&amp;Z)|(Y&amp;~Z) H(X,Y,Z)=X^Y^Z I(X,Y,Z)=Y^(X|~Z) 基于这四种非线性函数，MD5 会对每个分组进行 4 轮总共 64 次操作，以下操作的 a,b,c,d 初值等于上面的初始链接变量：
// 第一轮 FF(a,b,c,d,Mi,s,tj) 表示a=b&#43;((a&#43;F(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s)，其中&lt;&lt;&lt;表示循环左移 // Mi表示消息的子分组，因为每个分组为512bit，可以分为16个32bit的子分组 // tj表示常数数组的特定元素，由4294967296*abs(sin(j))的整数部分得到 FF(a,b,c,d,M0,7,0xd76aa478) FF(d,a,b,c,M1,12,0xe8c7b756) FF(c,d,a,b,M2,17,0×242070db) FF(b,c,d,a,M3,22,0xc1bdceee) FF(a,b,c,d,M4,7,0xf57c0faf) FF(d,a,b,c,M5,12,0×4787c62a) FF(c,d,a,b,M6,17,0xa8304613) FF(b,c,d,a,M7,22,0xfd469501) FF(a,b,c,d,M8,7,0×698098d8) FF(d,a,b,c,M9,12,0×8b44f7af) FF(c,d,a,b,M10,17,0xffff5bb1) FF(b,c,d,a,M11,22,0×895cd7be) FF(a,b,c,d,M12,7,0×6b901122) FF(d,a,b,c,M13,12,0xfd987193) FF(c,d,a,b,M14,17,0xa679438e) FF(b,c,d,a,M15,22,0×49b40821) // 第二轮 GG(a,b,c,d,Mi,s,tj) 表示 a=b&#43;((a&#43;G(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) GG(a,b,c,d,M1,5,0xf61e2562) GG(d,a,b,c,M6,9,0xc040b340) GG(c,d,a,b,M11,14,0×265e5a51) GG(b,c,d,a,M0,20,0xe9b6c7aa) GG(a,b,c,d,M5,5,0xd62f105d) GG(d,a,b,c,M10,9,0×02441453) GG(c,d,a,b,M15,14,0xd8a1e681) GG(b,c,d,a,M4,20,0xe7d3fbc8) GG(a,b,c,d,M9,5,0×21e1cde6) GG(d,a,b,c,M14,9,0xc33707d6) GG(c,d,a,b,M3,14,0xf4d50d87) GG(b,c,d,a,M8,20,0×455a14ed) GG(a,b,c,d,M13,5,0xa9e3e905) GG(d,a,b,c,M2,9,0xfcefa3f8) GG(c,d,a,b,M7,14,0×676f02d9) GG(b,c,d,a,M12,20,0×8d2a4c8a) // 第三轮 HH(a,b,c,d,Mi,s,tj) 表示 a=b&#43;((a&#43;H(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) HH(a,b,c,d,M5,4,0xfffa3942) HH(d,a,b,c,M8,11,0×8771f681) HH(c,d,a,b,M11,16,0×6d9d6122) HH(b,c,d,a,M14,23,0xfde5380c) HH(a,b,c,d,M1,4,0xa4beea44) HH(d,a,b,c,M4,11,0×4bdecfa9) HH(c,d,a,b,M7,16,0xf6bb4b60) HH(b,c,d,a,M10,23,0xbebfbc70) HH(a,b,c,d,M13,4,0×289b7ec6) HH(d,a,b,c,M0,11,0xeaa127fa) HH(c,d,a,b,M3,16,0xd4ef3085) HH(b,c,d,a,M6,23,0×04881d05) HH(a,b,c,d,M9,4,0xd9d4d039) HH(d,a,b,c,M12,11,0xe6db99e5) HH(c,d,a,b,M15,16,0×1fa27cf8) HH(b,c,d,a,M2,23,0xc4ac5665) // 第四轮 II(a,b,c,d,Mi,s,tj) 表示a=b&#43;((a&#43;I(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) II(a,b,c,d,M0,6,0xf4292244) II(d,a,b,c,M7,10,0×432aff97) II(c,d,a,b,M14,15,0xab9423a7) II(b,c,d,a,M5,21,0xfc93a039) II(a,b,c,d,M12,6,0×655b59c3) II(d,a,b,c,M3,10,0×8f0ccc92) II(c,d,a,b,M10,15,0xffeff47d) II(b,c,d,a,M1,21,0×85845dd1) II(a,b,c,d,M8,6,0×6fa87e4f) II(d,a,b,c,M15,10,0xfe2ce6e0) II(c,d,a,b,M6,15,0xa3014314) II(b,c,d,a,M13,21,0×4e0811a1) II(a,b,c,d,M4,6,0xf7537e82) II(d,a,b,c,M11,10,0xbd3af235) II(c,d,a,b,M2,15,0×2ad7d2bb) II(b,c,d,a,M9,21,0xeb86d391) 对一个分组执行 64 次操作后，更新 A,B,C,D 与 a,b,c,d 值：">
  <meta itemprop="datePublished" content="2024-11-13T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-11-13T00:00:00+00:00">
  <meta itemprop="wordCount" content="1307">
  
  <meta property="og:url" content="https://6uolong.github.io/posts/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95-md5/">
  <meta property="og:site_name" content="huolong blog">
  <meta property="og:title" content="MD5详解">
  <meta property="og:description" content="MD5（Message Digest Algorithm 5）是逆向中常见的一种签名生成算法，主要特点如下：
输入任意长度，输出 128 bit 固定长度的信息摘要。 运算速度快，MD5 中的运算以位运算（异或，与，或，非等）。 不可逆但已经发现碰撞。 算法原理 填充数据 首先需要对输入的数据进行填充，填充的第一位为 1，其余位为 0，使其最终长度模 512 的结果为 448（填充必须进行，哪怕长度正好满足要求，也会再填充 512 bit 的数据）。剩余 64 bit 填入原始长度。这时数据长度可以整除 512，将每 512 bit 数据作为一个分组。
分组数据运算 首先赋值四个初始链接变量，作为后续操作的基础：
A: 0x67452301 B: 0xefcdab89 C: 0x98badcfe D: 0x10325476 随后要提到四个非线性函数：
F(X,Y,Z)=(X&amp;Y)|(~X&amp;Z) G(X,Y,Z)=(X&amp;Z)|(Y&amp;~Z) H(X,Y,Z)=X^Y^Z I(X,Y,Z)=Y^(X|~Z) 基于这四种非线性函数，MD5 会对每个分组进行 4 轮总共 64 次操作，以下操作的 a,b,c,d 初值等于上面的初始链接变量：
// 第一轮 FF(a,b,c,d,Mi,s,tj) 表示a=b&#43;((a&#43;F(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s)，其中&lt;&lt;&lt;表示循环左移 // Mi表示消息的子分组，因为每个分组为512bit，可以分为16个32bit的子分组 // tj表示常数数组的特定元素，由4294967296*abs(sin(j))的整数部分得到 FF(a,b,c,d,M0,7,0xd76aa478) FF(d,a,b,c,M1,12,0xe8c7b756) FF(c,d,a,b,M2,17,0×242070db) FF(b,c,d,a,M3,22,0xc1bdceee) FF(a,b,c,d,M4,7,0xf57c0faf) FF(d,a,b,c,M5,12,0×4787c62a) FF(c,d,a,b,M6,17,0xa8304613) FF(b,c,d,a,M7,22,0xfd469501) FF(a,b,c,d,M8,7,0×698098d8) FF(d,a,b,c,M9,12,0×8b44f7af) FF(c,d,a,b,M10,17,0xffff5bb1) FF(b,c,d,a,M11,22,0×895cd7be) FF(a,b,c,d,M12,7,0×6b901122) FF(d,a,b,c,M13,12,0xfd987193) FF(c,d,a,b,M14,17,0xa679438e) FF(b,c,d,a,M15,22,0×49b40821) // 第二轮 GG(a,b,c,d,Mi,s,tj) 表示 a=b&#43;((a&#43;G(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) GG(a,b,c,d,M1,5,0xf61e2562) GG(d,a,b,c,M6,9,0xc040b340) GG(c,d,a,b,M11,14,0×265e5a51) GG(b,c,d,a,M0,20,0xe9b6c7aa) GG(a,b,c,d,M5,5,0xd62f105d) GG(d,a,b,c,M10,9,0×02441453) GG(c,d,a,b,M15,14,0xd8a1e681) GG(b,c,d,a,M4,20,0xe7d3fbc8) GG(a,b,c,d,M9,5,0×21e1cde6) GG(d,a,b,c,M14,9,0xc33707d6) GG(c,d,a,b,M3,14,0xf4d50d87) GG(b,c,d,a,M8,20,0×455a14ed) GG(a,b,c,d,M13,5,0xa9e3e905) GG(d,a,b,c,M2,9,0xfcefa3f8) GG(c,d,a,b,M7,14,0×676f02d9) GG(b,c,d,a,M12,20,0×8d2a4c8a) // 第三轮 HH(a,b,c,d,Mi,s,tj) 表示 a=b&#43;((a&#43;H(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) HH(a,b,c,d,M5,4,0xfffa3942) HH(d,a,b,c,M8,11,0×8771f681) HH(c,d,a,b,M11,16,0×6d9d6122) HH(b,c,d,a,M14,23,0xfde5380c) HH(a,b,c,d,M1,4,0xa4beea44) HH(d,a,b,c,M4,11,0×4bdecfa9) HH(c,d,a,b,M7,16,0xf6bb4b60) HH(b,c,d,a,M10,23,0xbebfbc70) HH(a,b,c,d,M13,4,0×289b7ec6) HH(d,a,b,c,M0,11,0xeaa127fa) HH(c,d,a,b,M3,16,0xd4ef3085) HH(b,c,d,a,M6,23,0×04881d05) HH(a,b,c,d,M9,4,0xd9d4d039) HH(d,a,b,c,M12,11,0xe6db99e5) HH(c,d,a,b,M15,16,0×1fa27cf8) HH(b,c,d,a,M2,23,0xc4ac5665) // 第四轮 II(a,b,c,d,Mi,s,tj) 表示a=b&#43;((a&#43;I(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) II(a,b,c,d,M0,6,0xf4292244) II(d,a,b,c,M7,10,0×432aff97) II(c,d,a,b,M14,15,0xab9423a7) II(b,c,d,a,M5,21,0xfc93a039) II(a,b,c,d,M12,6,0×655b59c3) II(d,a,b,c,M3,10,0×8f0ccc92) II(c,d,a,b,M10,15,0xffeff47d) II(b,c,d,a,M1,21,0×85845dd1) II(a,b,c,d,M8,6,0×6fa87e4f) II(d,a,b,c,M15,10,0xfe2ce6e0) II(c,d,a,b,M6,15,0xa3014314) II(b,c,d,a,M13,21,0×4e0811a1) II(a,b,c,d,M4,6,0xf7537e82) II(d,a,b,c,M11,10,0xbd3af235) II(c,d,a,b,M2,15,0×2ad7d2bb) II(b,c,d,a,M9,21,0xeb86d391) 对一个分组执行 64 次操作后，更新 A,B,C,D 与 a,b,c,d 值：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-11-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-13T00:00:00+00:00">

  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="MD5详解">
  <meta name="twitter:description" content="MD5（Message Digest Algorithm 5）是逆向中常见的一种签名生成算法，主要特点如下：
输入任意长度，输出 128 bit 固定长度的信息摘要。 运算速度快，MD5 中的运算以位运算（异或，与，或，非等）。 不可逆但已经发现碰撞。 算法原理 填充数据 首先需要对输入的数据进行填充，填充的第一位为 1，其余位为 0，使其最终长度模 512 的结果为 448（填充必须进行，哪怕长度正好满足要求，也会再填充 512 bit 的数据）。剩余 64 bit 填入原始长度。这时数据长度可以整除 512，将每 512 bit 数据作为一个分组。
分组数据运算 首先赋值四个初始链接变量，作为后续操作的基础：
A: 0x67452301 B: 0xefcdab89 C: 0x98badcfe D: 0x10325476 随后要提到四个非线性函数：
F(X,Y,Z)=(X&amp;Y)|(~X&amp;Z) G(X,Y,Z)=(X&amp;Z)|(Y&amp;~Z) H(X,Y,Z)=X^Y^Z I(X,Y,Z)=Y^(X|~Z) 基于这四种非线性函数，MD5 会对每个分组进行 4 轮总共 64 次操作，以下操作的 a,b,c,d 初值等于上面的初始链接变量：
// 第一轮 FF(a,b,c,d,Mi,s,tj) 表示a=b&#43;((a&#43;F(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s)，其中&lt;&lt;&lt;表示循环左移 // Mi表示消息的子分组，因为每个分组为512bit，可以分为16个32bit的子分组 // tj表示常数数组的特定元素，由4294967296*abs(sin(j))的整数部分得到 FF(a,b,c,d,M0,7,0xd76aa478) FF(d,a,b,c,M1,12,0xe8c7b756) FF(c,d,a,b,M2,17,0×242070db) FF(b,c,d,a,M3,22,0xc1bdceee) FF(a,b,c,d,M4,7,0xf57c0faf) FF(d,a,b,c,M5,12,0×4787c62a) FF(c,d,a,b,M6,17,0xa8304613) FF(b,c,d,a,M7,22,0xfd469501) FF(a,b,c,d,M8,7,0×698098d8) FF(d,a,b,c,M9,12,0×8b44f7af) FF(c,d,a,b,M10,17,0xffff5bb1) FF(b,c,d,a,M11,22,0×895cd7be) FF(a,b,c,d,M12,7,0×6b901122) FF(d,a,b,c,M13,12,0xfd987193) FF(c,d,a,b,M14,17,0xa679438e) FF(b,c,d,a,M15,22,0×49b40821) // 第二轮 GG(a,b,c,d,Mi,s,tj) 表示 a=b&#43;((a&#43;G(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) GG(a,b,c,d,M1,5,0xf61e2562) GG(d,a,b,c,M6,9,0xc040b340) GG(c,d,a,b,M11,14,0×265e5a51) GG(b,c,d,a,M0,20,0xe9b6c7aa) GG(a,b,c,d,M5,5,0xd62f105d) GG(d,a,b,c,M10,9,0×02441453) GG(c,d,a,b,M15,14,0xd8a1e681) GG(b,c,d,a,M4,20,0xe7d3fbc8) GG(a,b,c,d,M9,5,0×21e1cde6) GG(d,a,b,c,M14,9,0xc33707d6) GG(c,d,a,b,M3,14,0xf4d50d87) GG(b,c,d,a,M8,20,0×455a14ed) GG(a,b,c,d,M13,5,0xa9e3e905) GG(d,a,b,c,M2,9,0xfcefa3f8) GG(c,d,a,b,M7,14,0×676f02d9) GG(b,c,d,a,M12,20,0×8d2a4c8a) // 第三轮 HH(a,b,c,d,Mi,s,tj) 表示 a=b&#43;((a&#43;H(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) HH(a,b,c,d,M5,4,0xfffa3942) HH(d,a,b,c,M8,11,0×8771f681) HH(c,d,a,b,M11,16,0×6d9d6122) HH(b,c,d,a,M14,23,0xfde5380c) HH(a,b,c,d,M1,4,0xa4beea44) HH(d,a,b,c,M4,11,0×4bdecfa9) HH(c,d,a,b,M7,16,0xf6bb4b60) HH(b,c,d,a,M10,23,0xbebfbc70) HH(a,b,c,d,M13,4,0×289b7ec6) HH(d,a,b,c,M0,11,0xeaa127fa) HH(c,d,a,b,M3,16,0xd4ef3085) HH(b,c,d,a,M6,23,0×04881d05) HH(a,b,c,d,M9,4,0xd9d4d039) HH(d,a,b,c,M12,11,0xe6db99e5) HH(c,d,a,b,M15,16,0×1fa27cf8) HH(b,c,d,a,M2,23,0xc4ac5665) // 第四轮 II(a,b,c,d,Mi,s,tj) 表示a=b&#43;((a&#43;I(b,c,d)&#43;Mi&#43;tj)&lt;&lt;&lt;s) II(a,b,c,d,M0,6,0xf4292244) II(d,a,b,c,M7,10,0×432aff97) II(c,d,a,b,M14,15,0xab9423a7) II(b,c,d,a,M5,21,0xfc93a039) II(a,b,c,d,M12,6,0×655b59c3) II(d,a,b,c,M3,10,0×8f0ccc92) II(c,d,a,b,M10,15,0xffeff47d) II(b,c,d,a,M1,21,0×85845dd1) II(a,b,c,d,M8,6,0×6fa87e4f) II(d,a,b,c,M15,10,0xfe2ce6e0) II(c,d,a,b,M6,15,0xa3014314) II(b,c,d,a,M13,21,0×4e0811a1) II(a,b,c,d,M4,6,0xf7537e82) II(d,a,b,c,M11,10,0xbd3af235) II(c,d,a,b,M2,15,0×2ad7d2bb) II(b,c,d,a,M9,21,0xeb86d391) 对一个分组执行 64 次操作后，更新 A,B,C,D 与 a,b,c,d 值：">

  
  

  
  <link rel="canonical" href="https://6uolong.github.io/posts/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95-md5/" />
  
  
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header class="mx-auto flex h-[4.5rem] max-w-[--w] px-8 lg:justify-center">
  <div class="relative z-50 ltr:mr-auto rtl:ml-auto flex items-center">
    <a class="-translate-y-[1px] text-2xl font-medium" href="https://6uolong.github.io/"
      >huolong blog</a
    >
    <div
      class="btn-dark text-[0] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 ltr:-mr-8 rtl:-ml-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
    role="button"
    aria-label="Menu"
  ></div>

  

  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#faf8f1'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"
  >
    
    

    
  </div>
</header>


    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-[--w] px-8 pb-16 pt-14 dark:prose-invert"
    >
      

<article>
  <header class="mb-14">
    <h1 class="!my-0 pb-2.5">MD5详解</h1>

    
    <div class="text-xs antialiased opacity-60">
      
      <time>Nov 13, 2024</time>
      
      
      
      
    </div>
    
  </header>

  <section><p>MD5（Message Digest Algorithm 5）是逆向中常见的一种签名生成算法，主要特点如下：</p>
<ol>
<li>输入任意长度，输出 128 bit 固定长度的信息摘要。</li>
<li>运算速度快，MD5 中的运算以位运算（异或，与，或，非等）。</li>
<li>不可逆但已经发现碰撞。</li>
</ol>
<h3 id="算法原理">算法原理</h3>
<h4 id="填充数据">填充数据</h4>
<p>首先需要对输入的数据进行填充，填充的第一位为 1，其余位为 0，使其最终长度模 512 的结果为 448（填充必须进行，哪怕长度正好满足要求，也会再填充 512 bit 的数据）。剩余 64 bit 填入原始长度。这时数据长度可以整除 512，将每 512 bit 数据作为一个分组。</p>
<h4 id="分组数据运算">分组数据运算</h4>
<p>首先赋值四个初始链接变量，作为后续操作的基础：</p>
<pre tabindex="0"><code>A: 0x67452301 B: 0xefcdab89 C: 0x98badcfe D: 0x10325476
</code></pre><p>随后要提到四个非线性函数：</p>
<pre tabindex="0"><code>F(X,Y,Z)=(X&amp;Y)|(~X&amp;Z)
G(X,Y,Z)=(X&amp;Z)|(Y&amp;~Z)
H(X,Y,Z)=X^Y^Z
I(X,Y,Z)=Y^(X|~Z)
</code></pre><p>基于这四种非线性函数，MD5 会对每个分组进行 4 轮总共 64 次操作，以下操作的 <code>a,b,c,d</code> 初值等于上面的初始链接变量：</p>
<pre tabindex="0"><code>// 第一轮 FF(a,b,c,d,Mi,s,tj) 表示a=b+((a+F(b,c,d)+Mi+tj)&lt;&lt;&lt;s)，其中&lt;&lt;&lt;表示循环左移
// Mi表示消息的子分组，因为每个分组为512bit，可以分为16个32bit的子分组
// tj表示常数数组的特定元素，由4294967296*abs(sin(j))的整数部分得到
FF(a,b,c,d,M0,7,0xd76aa478)
FF(d,a,b,c,M1,12,0xe8c7b756)
FF(c,d,a,b,M2,17,0×242070db)
FF(b,c,d,a,M3,22,0xc1bdceee)
FF(a,b,c,d,M4,7,0xf57c0faf)
FF(d,a,b,c,M5,12,0×4787c62a)
FF(c,d,a,b,M6,17,0xa8304613)
FF(b,c,d,a,M7,22,0xfd469501)
FF(a,b,c,d,M8,7,0×698098d8)
FF(d,a,b,c,M9,12,0×8b44f7af)
FF(c,d,a,b,M10,17,0xffff5bb1)
FF(b,c,d,a,M11,22,0×895cd7be)
FF(a,b,c,d,M12,7,0×6b901122)
FF(d,a,b,c,M13,12,0xfd987193)
FF(c,d,a,b,M14,17,0xa679438e)
FF(b,c,d,a,M15,22,0×49b40821)

// 第二轮 GG(a,b,c,d,Mi,s,tj) 表示 a=b+((a+G(b,c,d)+Mi+tj)&lt;&lt;&lt;s)
GG(a,b,c,d,M1,5,0xf61e2562)
GG(d,a,b,c,M6,9,0xc040b340)
GG(c,d,a,b,M11,14,0×265e5a51)
GG(b,c,d,a,M0,20,0xe9b6c7aa)
GG(a,b,c,d,M5,5,0xd62f105d)
GG(d,a,b,c,M10,9,0×02441453)
GG(c,d,a,b,M15,14,0xd8a1e681)
GG(b,c,d,a,M4,20,0xe7d3fbc8)
GG(a,b,c,d,M9,5,0×21e1cde6)
GG(d,a,b,c,M14,9,0xc33707d6)
GG(c,d,a,b,M3,14,0xf4d50d87)
GG(b,c,d,a,M8,20,0×455a14ed)
GG(a,b,c,d,M13,5,0xa9e3e905)
GG(d,a,b,c,M2,9,0xfcefa3f8)
GG(c,d,a,b,M7,14,0×676f02d9)
GG(b,c,d,a,M12,20,0×8d2a4c8a)

// 第三轮 HH(a,b,c,d,Mi,s,tj) 表示 a=b+((a+H(b,c,d)+Mi+tj)&lt;&lt;&lt;s)
HH(a,b,c,d,M5,4,0xfffa3942)
HH(d,a,b,c,M8,11,0×8771f681)
HH(c,d,a,b,M11,16,0×6d9d6122)
HH(b,c,d,a,M14,23,0xfde5380c)
HH(a,b,c,d,M1,4,0xa4beea44)
HH(d,a,b,c,M4,11,0×4bdecfa9)
HH(c,d,a,b,M7,16,0xf6bb4b60)
HH(b,c,d,a,M10,23,0xbebfbc70)
HH(a,b,c,d,M13,4,0×289b7ec6)
HH(d,a,b,c,M0,11,0xeaa127fa)
HH(c,d,a,b,M3,16,0xd4ef3085)
HH(b,c,d,a,M6,23,0×04881d05)
HH(a,b,c,d,M9,4,0xd9d4d039)
HH(d,a,b,c,M12,11,0xe6db99e5)
HH(c,d,a,b,M15,16,0×1fa27cf8)
HH(b,c,d,a,M2,23,0xc4ac5665)

// 第四轮 II(a,b,c,d,Mi,s,tj) 表示a=b+((a+I(b,c,d)+Mi+tj)&lt;&lt;&lt;s)
II(a,b,c,d,M0,6,0xf4292244)
II(d,a,b,c,M7,10,0×432aff97)
II(c,d,a,b,M14,15,0xab9423a7)
II(b,c,d,a,M5,21,0xfc93a039)
II(a,b,c,d,M12,6,0×655b59c3)
II(d,a,b,c,M3,10,0×8f0ccc92)
II(c,d,a,b,M10,15,0xffeff47d)
II(b,c,d,a,M1,21,0×85845dd1)
II(a,b,c,d,M8,6,0×6fa87e4f)
II(d,a,b,c,M15,10,0xfe2ce6e0)
II(c,d,a,b,M6,15,0xa3014314)
II(b,c,d,a,M13,21,0×4e0811a1)
II(a,b,c,d,M4,6,0xf7537e82)
II(d,a,b,c,M11,10,0xbd3af235)
II(c,d,a,b,M2,15,0×2ad7d2bb)
II(b,c,d,a,M9,21,0xeb86d391)
</code></pre><p>对一个分组执行 64 次操作后，更新 <code>A,B,C,D</code> 与 <code>a,b,c,d</code> 值：</p>
<pre tabindex="0"><code>A=A+a
B=B+b 
C=C+c
D=D+d
a=A
b=B
c=C
d=D
</code></pre><p>将新的 <code>a,b,c,d</code> 参与到下一个分组的运算中，并不断更新 <code>A,B,C,D</code> 的值，当所有的分组运算完毕后，将 <code>A,B,C,D</code> 拼接起来并按照小端序展示即可。</p>
<h4 id="md5-python-实现">MD5 Python 实现</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> binascii
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os.path
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SV <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xd76aa478</span>, <span style="color:#ae81ff">0xe8c7b756</span>, <span style="color:#ae81ff">0x242070db</span>, <span style="color:#ae81ff">0xc1bdceee</span>, <span style="color:#ae81ff">0xf57c0faf</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0x4787c62a</span>, <span style="color:#ae81ff">0xa8304613</span>, <span style="color:#ae81ff">0xfd469501</span>, <span style="color:#ae81ff">0x698098d8</span>, <span style="color:#ae81ff">0x8b44f7af</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0xffff5bb1</span>, <span style="color:#ae81ff">0x895cd7be</span>, <span style="color:#ae81ff">0x6b901122</span>, <span style="color:#ae81ff">0xfd987193</span>, <span style="color:#ae81ff">0xa679438e</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0x49b40821</span>, <span style="color:#ae81ff">0xf61e2562</span>, <span style="color:#ae81ff">0xc040b340</span>, <span style="color:#ae81ff">0x265e5a51</span>, <span style="color:#ae81ff">0xe9b6c7aa</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0xd62f105d</span>, <span style="color:#ae81ff">0x2441453</span>, <span style="color:#ae81ff">0xd8a1e681</span>, <span style="color:#ae81ff">0xe7d3fbc8</span>, <span style="color:#ae81ff">0x21e1cde6</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0xc33707d6</span>, <span style="color:#ae81ff">0xf4d50d87</span>, <span style="color:#ae81ff">0x455a14ed</span>, <span style="color:#ae81ff">0xa9e3e905</span>, <span style="color:#ae81ff">0xfcefa3f8</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0x676f02d9</span>, <span style="color:#ae81ff">0x8d2a4c8a</span>, <span style="color:#ae81ff">0xfffa3942</span>, <span style="color:#ae81ff">0x8771f681</span>, <span style="color:#ae81ff">0x6d9d6122</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0xfde5380c</span>, <span style="color:#ae81ff">0xa4beea44</span>, <span style="color:#ae81ff">0x4bdecfa9</span>, <span style="color:#ae81ff">0xf6bb4b60</span>, <span style="color:#ae81ff">0xbebfbc70</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0x289b7ec6</span>, <span style="color:#ae81ff">0xeaa127fa</span>, <span style="color:#ae81ff">0xd4ef3085</span>, <span style="color:#ae81ff">0x4881d05</span>, <span style="color:#ae81ff">0xd9d4d039</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0xe6db99e5</span>, <span style="color:#ae81ff">0x1fa27cf8</span>, <span style="color:#ae81ff">0xc4ac5665</span>, <span style="color:#ae81ff">0xf4292244</span>, <span style="color:#ae81ff">0x432aff97</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0xab9423a7</span>, <span style="color:#ae81ff">0xfc93a039</span>, <span style="color:#ae81ff">0x655b59c3</span>, <span style="color:#ae81ff">0x8f0ccc92</span>, <span style="color:#ae81ff">0xffeff47d</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0x85845dd1</span>, <span style="color:#ae81ff">0x6fa87e4f</span>, <span style="color:#ae81ff">0xfe2ce6e0</span>, <span style="color:#ae81ff">0xa3014314</span>, <span style="color:#ae81ff">0x4e0811a1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0xf7537e82</span>, <span style="color:#ae81ff">0xbd3af235</span>, <span style="color:#ae81ff">0x2ad7d2bb</span>, <span style="color:#ae81ff">0xeb86d391</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 根据ascil编码把字符转成对应的二进制</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">binvalue</span>(val, bitsize):
</span></span><span style="display:flex;"><span>    binval <span style="color:#f92672">=</span> bin(val)[<span style="color:#ae81ff">2</span>:] <span style="color:#66d9ef">if</span> isinstance(val, int) <span style="color:#66d9ef">else</span> bin(ord(val))[<span style="color:#ae81ff">2</span>:]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(binval) <span style="color:#f92672">&gt;</span> bitsize:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> (<span style="color:#e6db74">&#34;binary value larger than the expected size&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> len(binval) <span style="color:#f92672">&lt;</span> bitsize:
</span></span><span style="display:flex;"><span>        binval <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#f92672">+</span> binval
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> binval
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">string_to_bit_array</span>(text):
</span></span><span style="display:flex;"><span>    array <span style="color:#f92672">=</span> list()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> text:
</span></span><span style="display:flex;"><span>        binval <span style="color:#f92672">=</span> binvalue(char, <span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>        array<span style="color:#f92672">.</span>extend([int(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> list(binval)])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> array
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 循环左移</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">leftCircularShift</span>(k, bits):
</span></span><span style="display:flex;"><span>    bits <span style="color:#f92672">=</span> bits <span style="color:#f92672">%</span> <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> k <span style="color:#f92672">%</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>    upper <span style="color:#f92672">=</span> (k <span style="color:#f92672">&lt;&lt;</span> bits) <span style="color:#f92672">%</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> upper <span style="color:#f92672">|</span> (k <span style="color:#f92672">&gt;&gt;</span> (<span style="color:#ae81ff">32</span> <span style="color:#f92672">-</span> (bits)))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 分块</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">blockDivide</span>(block, chunks):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    size <span style="color:#f92672">=</span> len(block) <span style="color:#f92672">//</span> chunks
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, chunks):
</span></span><span style="display:flex;"><span>        result<span style="color:#f92672">.</span>append(int<span style="color:#f92672">.</span>from_bytes(block[i <span style="color:#f92672">*</span> size:(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> size], byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;little&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># F函数作用于“比特位”上</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if x then y else z</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F</span>(X, Y, Z):
</span></span><span style="display:flex;"><span>    compute <span style="color:#f92672">=</span> ((X <span style="color:#f92672">&amp;</span> Y) <span style="color:#f92672">|</span> ((<span style="color:#f92672">~</span>X) <span style="color:#f92672">&amp;</span> Z))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> compute
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if z then x else y</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">G</span>(X, Y, Z):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ((X <span style="color:#f92672">&amp;</span> Z) <span style="color:#f92672">|</span> (Y <span style="color:#f92672">&amp;</span> (<span style="color:#f92672">~</span>Z)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if X = Y then Z else ~Z</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">H</span>(X, Y, Z):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (X <span style="color:#f92672">^</span> Y <span style="color:#f92672">^</span> Z)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">I</span>(X, Y, Z):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (Y <span style="color:#f92672">^</span> (X <span style="color:#f92672">|</span> (<span style="color:#f92672">~</span>Z)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 四个F函数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">FF</span>(a, b, c, d, M, s, t):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> b <span style="color:#f92672">+</span> leftCircularShift((a <span style="color:#f92672">+</span> F(b, c, d) <span style="color:#f92672">+</span> M <span style="color:#f92672">+</span> t), s)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GG</span>(a, b, c, d, M, s, t):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> b <span style="color:#f92672">+</span> leftCircularShift((a <span style="color:#f92672">+</span> G(b, c, d) <span style="color:#f92672">+</span> M <span style="color:#f92672">+</span> t), s)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">HH</span>(a, b, c, d, M, s, t):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> b <span style="color:#f92672">+</span> leftCircularShift((a <span style="color:#f92672">+</span> H(b, c, d) <span style="color:#f92672">+</span> M <span style="color:#f92672">+</span> t), s)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">II</span>(a, b, c, d, M, s, t):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> b <span style="color:#f92672">+</span> leftCircularShift((a <span style="color:#f92672">+</span> I(b, c, d) <span style="color:#f92672">+</span> M <span style="color:#f92672">+</span> t), s)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 数据转换</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fmt8</span>(num):
</span></span><span style="display:flex;"><span>    bighex <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{0:08x}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(num)
</span></span><span style="display:flex;"><span>    binver <span style="color:#f92672">=</span> binascii<span style="color:#f92672">.</span>unhexlify(bighex)
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{0:08x}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(int<span style="color:#f92672">.</span>from_bytes(binver, byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;little&#39;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 计算比特长度</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bitlen</span>(bitstring):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> len(bitstring) <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">md5sum</span>(msg):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 计算比特长度，如果内容过长，64个比特放不下。就取低64bit。</span>
</span></span><span style="display:flex;"><span>    msgLen <span style="color:#f92672">=</span> bitlen(msg) <span style="color:#f92672">%</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 先填充一个0x80，其实是先填充一个1，后面跟对应个数的0，因为一个明文的编码至少需要8比特，所以直接填充 0b10000000即0x80</span>
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> msg <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x80</span><span style="color:#e6db74">&#39;</span>  <span style="color:#75715e"># 0x80 = 1000 0000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 似乎各种编码，即使是一个字母，都至少得1个字节，即8bit才能表示，所以不会出现原文55bit，pad1就满足的情况？可是不对呀，要是二进制文件呢？</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 填充0到满足要求为止。</span>
</span></span><span style="display:flex;"><span>    zeroPad <span style="color:#f92672">=</span> (<span style="color:#ae81ff">448</span> <span style="color:#f92672">-</span> (msgLen <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">512</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">512</span>
</span></span><span style="display:flex;"><span>    zeroPad <span style="color:#f92672">//=</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> msg <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> zeroPad <span style="color:#f92672">+</span> msgLen<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">8</span>, byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;little&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 计算循环轮数，512个为一轮</span>
</span></span><span style="display:flex;"><span>    msgLen <span style="color:#f92672">=</span> bitlen(msg)
</span></span><span style="display:flex;"><span>    iterations <span style="color:#f92672">=</span> msgLen <span style="color:#f92672">//</span> <span style="color:#ae81ff">512</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 初始化变量</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 算法魔改的第一个点，也是最明显的点</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># A = 0x67452301</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># B = 0xefcdab89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># C = 0x98badcfe</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># D = 0x10325476</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># MD5的主体就是对abcd进行n次的迭代，所以得有个初始值，可以随便选，也可以用默认的魔数，这个改起来毫无风险，所以大家爱魔改它，甚至改这个都不算魔改。</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># main loop</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, iterations):
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> A
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> B
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> C
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> D
</span></span><span style="display:flex;"><span>        block <span style="color:#f92672">=</span> msg[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">64</span>:(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">64</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 明文的处理，顺便调整了一下端序</span>
</span></span><span style="display:flex;"><span>        M <span style="color:#f92672">=</span> blockDivide(block, <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Rounds</span>
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> FF(a, b, c, d, M[<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">7</span>, SV[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> FF(d, a, b, c, M[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">12</span>, SV[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> FF(c, d, a, b, M[<span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">17</span>, SV[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> FF(b, c, d, a, M[<span style="color:#ae81ff">3</span>], <span style="color:#ae81ff">22</span>, SV[<span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> FF(a, b, c, d, M[<span style="color:#ae81ff">4</span>], <span style="color:#ae81ff">7</span>, SV[<span style="color:#ae81ff">4</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> FF(d, a, b, c, M[<span style="color:#ae81ff">5</span>], <span style="color:#ae81ff">12</span>, SV[<span style="color:#ae81ff">5</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> FF(c, d, a, b, M[<span style="color:#ae81ff">6</span>], <span style="color:#ae81ff">17</span>, SV[<span style="color:#ae81ff">6</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> FF(b, c, d, a, M[<span style="color:#ae81ff">7</span>], <span style="color:#ae81ff">22</span>, SV[<span style="color:#ae81ff">7</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> FF(a, b, c, d, M[<span style="color:#ae81ff">8</span>], <span style="color:#ae81ff">7</span>, SV[<span style="color:#ae81ff">8</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> FF(d, a, b, c, M[<span style="color:#ae81ff">9</span>], <span style="color:#ae81ff">12</span>, SV[<span style="color:#ae81ff">9</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> FF(c, d, a, b, M[<span style="color:#ae81ff">10</span>], <span style="color:#ae81ff">17</span>, SV[<span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> FF(b, c, d, a, M[<span style="color:#ae81ff">11</span>], <span style="color:#ae81ff">22</span>, SV[<span style="color:#ae81ff">11</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> FF(a, b, c, d, M[<span style="color:#ae81ff">12</span>], <span style="color:#ae81ff">7</span>, SV[<span style="color:#ae81ff">12</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> FF(d, a, b, c, M[<span style="color:#ae81ff">13</span>], <span style="color:#ae81ff">12</span>, SV[<span style="color:#ae81ff">13</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> FF(c, d, a, b, M[<span style="color:#ae81ff">14</span>], <span style="color:#ae81ff">17</span>, SV[<span style="color:#ae81ff">14</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> FF(b, c, d, a, M[<span style="color:#ae81ff">15</span>], <span style="color:#ae81ff">22</span>, SV[<span style="color:#ae81ff">15</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> GG(a, b, c, d, M[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">5</span>, SV[<span style="color:#ae81ff">16</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> GG(d, a, b, c, M[<span style="color:#ae81ff">6</span>], <span style="color:#ae81ff">9</span>, SV[<span style="color:#ae81ff">17</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> GG(c, d, a, b, M[<span style="color:#ae81ff">11</span>], <span style="color:#ae81ff">14</span>, SV[<span style="color:#ae81ff">18</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> GG(b, c, d, a, M[<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">20</span>, SV[<span style="color:#ae81ff">19</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> GG(a, b, c, d, M[<span style="color:#ae81ff">5</span>], <span style="color:#ae81ff">5</span>, SV[<span style="color:#ae81ff">20</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> GG(d, a, b, c, M[<span style="color:#ae81ff">10</span>], <span style="color:#ae81ff">9</span>, SV[<span style="color:#ae81ff">21</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> GG(c, d, a, b, M[<span style="color:#ae81ff">15</span>], <span style="color:#ae81ff">14</span>, SV[<span style="color:#ae81ff">22</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> GG(b, c, d, a, M[<span style="color:#ae81ff">4</span>], <span style="color:#ae81ff">20</span>, SV[<span style="color:#ae81ff">23</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> GG(a, b, c, d, M[<span style="color:#ae81ff">9</span>], <span style="color:#ae81ff">5</span>, SV[<span style="color:#ae81ff">24</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> GG(d, a, b, c, M[<span style="color:#ae81ff">14</span>], <span style="color:#ae81ff">9</span>, SV[<span style="color:#ae81ff">25</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> GG(c, d, a, b, M[<span style="color:#ae81ff">3</span>], <span style="color:#ae81ff">14</span>, SV[<span style="color:#ae81ff">26</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> GG(b, c, d, a, M[<span style="color:#ae81ff">8</span>], <span style="color:#ae81ff">20</span>, SV[<span style="color:#ae81ff">27</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> GG(a, b, c, d, M[<span style="color:#ae81ff">13</span>], <span style="color:#ae81ff">5</span>, SV[<span style="color:#ae81ff">28</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> GG(d, a, b, c, M[<span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">9</span>, SV[<span style="color:#ae81ff">29</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> GG(c, d, a, b, M[<span style="color:#ae81ff">7</span>], <span style="color:#ae81ff">14</span>, SV[<span style="color:#ae81ff">30</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> GG(b, c, d, a, M[<span style="color:#ae81ff">12</span>], <span style="color:#ae81ff">20</span>, SV[<span style="color:#ae81ff">31</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> HH(a, b, c, d, M[<span style="color:#ae81ff">5</span>], <span style="color:#ae81ff">4</span>, SV[<span style="color:#ae81ff">32</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> HH(d, a, b, c, M[<span style="color:#ae81ff">8</span>], <span style="color:#ae81ff">11</span>, SV[<span style="color:#ae81ff">33</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> HH(c, d, a, b, M[<span style="color:#ae81ff">11</span>], <span style="color:#ae81ff">16</span>, SV[<span style="color:#ae81ff">34</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> HH(b, c, d, a, M[<span style="color:#ae81ff">14</span>], <span style="color:#ae81ff">23</span>, SV[<span style="color:#ae81ff">35</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> HH(a, b, c, d, M[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">4</span>, SV[<span style="color:#ae81ff">36</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> HH(d, a, b, c, M[<span style="color:#ae81ff">4</span>], <span style="color:#ae81ff">11</span>, SV[<span style="color:#ae81ff">37</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> HH(c, d, a, b, M[<span style="color:#ae81ff">7</span>], <span style="color:#ae81ff">16</span>, SV[<span style="color:#ae81ff">38</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> HH(b, c, d, a, M[<span style="color:#ae81ff">10</span>], <span style="color:#ae81ff">23</span>, SV[<span style="color:#ae81ff">39</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> HH(a, b, c, d, M[<span style="color:#ae81ff">13</span>], <span style="color:#ae81ff">4</span>, SV[<span style="color:#ae81ff">40</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> HH(d, a, b, c, M[<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">11</span>, SV[<span style="color:#ae81ff">41</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> HH(c, d, a, b, M[<span style="color:#ae81ff">3</span>], <span style="color:#ae81ff">16</span>, SV[<span style="color:#ae81ff">42</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> HH(b, c, d, a, M[<span style="color:#ae81ff">6</span>], <span style="color:#ae81ff">23</span>, SV[<span style="color:#ae81ff">43</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> HH(a, b, c, d, M[<span style="color:#ae81ff">9</span>], <span style="color:#ae81ff">4</span>, SV[<span style="color:#ae81ff">44</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> HH(d, a, b, c, M[<span style="color:#ae81ff">12</span>], <span style="color:#ae81ff">11</span>, SV[<span style="color:#ae81ff">45</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> HH(c, d, a, b, M[<span style="color:#ae81ff">15</span>], <span style="color:#ae81ff">16</span>, SV[<span style="color:#ae81ff">46</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> HH(b, c, d, a, M[<span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">23</span>, SV[<span style="color:#ae81ff">47</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> II(a, b, c, d, M[<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">6</span>, SV[<span style="color:#ae81ff">48</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> II(d, a, b, c, M[<span style="color:#ae81ff">7</span>], <span style="color:#ae81ff">10</span>, SV[<span style="color:#ae81ff">49</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> II(c, d, a, b, M[<span style="color:#ae81ff">14</span>], <span style="color:#ae81ff">15</span>, SV[<span style="color:#ae81ff">50</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> II(b, c, d, a, M[<span style="color:#ae81ff">5</span>], <span style="color:#ae81ff">21</span>, SV[<span style="color:#ae81ff">51</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> II(a, b, c, d, M[<span style="color:#ae81ff">12</span>], <span style="color:#ae81ff">6</span>, SV[<span style="color:#ae81ff">52</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> II(d, a, b, c, M[<span style="color:#ae81ff">3</span>], <span style="color:#ae81ff">10</span>, SV[<span style="color:#ae81ff">53</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> II(c, d, a, b, M[<span style="color:#ae81ff">10</span>], <span style="color:#ae81ff">15</span>, SV[<span style="color:#ae81ff">54</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> II(b, c, d, a, M[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">21</span>, SV[<span style="color:#ae81ff">55</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> II(a, b, c, d, M[<span style="color:#ae81ff">8</span>], <span style="color:#ae81ff">6</span>, SV[<span style="color:#ae81ff">56</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> II(d, a, b, c, M[<span style="color:#ae81ff">15</span>], <span style="color:#ae81ff">10</span>, SV[<span style="color:#ae81ff">57</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> II(c, d, a, b, M[<span style="color:#ae81ff">6</span>], <span style="color:#ae81ff">15</span>, SV[<span style="color:#ae81ff">58</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> II(b, c, d, a, M[<span style="color:#ae81ff">13</span>], <span style="color:#ae81ff">21</span>, SV[<span style="color:#ae81ff">59</span>])
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> II(a, b, c, d, M[<span style="color:#ae81ff">4</span>], <span style="color:#ae81ff">6</span>, SV[<span style="color:#ae81ff">60</span>])
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> II(d, a, b, c, M[<span style="color:#ae81ff">11</span>], <span style="color:#ae81ff">10</span>, SV[<span style="color:#ae81ff">61</span>])
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> II(c, d, a, b, M[<span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">15</span>, SV[<span style="color:#ae81ff">62</span>])
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> II(b, c, d, a, M[<span style="color:#ae81ff">9</span>], <span style="color:#ae81ff">21</span>, SV[<span style="color:#ae81ff">63</span>])
</span></span><span style="display:flex;"><span>        A <span style="color:#f92672">=</span> (A <span style="color:#f92672">+</span> a) <span style="color:#f92672">%</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>        B <span style="color:#f92672">=</span> (B <span style="color:#f92672">+</span> b) <span style="color:#f92672">%</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>        C <span style="color:#f92672">=</span> (C <span style="color:#f92672">+</span> c) <span style="color:#f92672">%</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>        D <span style="color:#f92672">=</span> (D <span style="color:#f92672">+</span> d) <span style="color:#f92672">%</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> fmt8(A) <span style="color:#f92672">+</span> fmt8(B) <span style="color:#f92672">+</span> fmt8(C) <span style="color:#f92672">+</span> fmt8(D)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> str(<span style="color:#e6db74">&#34;123456&#34;</span>)<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#34;UTF-8&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;plainText: &#34;</span>, data)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;result: &#34;</span>, md5sum(data))
</span></span></code></pre></div></section>

  
  

  
  
  
  
  <nav
    class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg !leading-[1.2] *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"
  >
    
    <a class="ltr:pr-3 rtl:pl-3" href="https://6uolong.github.io/posts/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95-sha256/"
      ><span class="ltr:mr-1.5 rtl:ml-1.5">←</span><span>SHA256详解</span></a
    >
    
    
    <a class="ltr:ml-auto rtl:mr-auto justify-end pl-3" href="https://6uolong.github.io/posts/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95-sha1/"
      ><span>SHA1详解</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a
    >
    
  </nav>
  
  

  
  

  
  

  


  
</article>


    </main>

    <footer
  class="mx-auto flex h-[4.5rem] max-w-[--w] items-center px-8 text-xs uppercase tracking-wider opacity-60"
>
  <div class="mr-auto">
  
    &copy; 2024
    <a class="link" href="https://6uolong.github.io/">huolong blog</a>
  
  </div>
  <a class="link mx-6" href="https://gohugo.io/" rel="noopener" target="_blank"
    >powered by hugo️️</a
  >️
  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
    >hugo-paper</a
  >
</footer>

  </body>
</html>
